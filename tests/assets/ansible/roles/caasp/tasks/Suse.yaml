---
- name: add repositories
  vars:
    repositories:
      caasp_devel: http://download.suse.de/ibs/Devel:/CaaSP:/4.0/SLE_15_SP1/
      suse_ca: http://download.suse.de/ibs/SUSE:/CA/SLE_15_SP1/
      storage: http://download.suse.de/ibs/SUSE:/SLE-15-SP2:/Update:/Products:/SES7/standard
  zypper_repository:
    name: '{{ repo.key }}'
    repo: '{{ repo.value }}'
    state: present
    auto_import_keys: yes
  loop: "{{ lookup('dict', repositories) }}"
  loop_control:
    loop_var: repo

- name: add packages
  vars:
    pkg:
      - ca-certificates-suse
      # kernel-default-base is not enough (skuba needs vxlan which is not in the base kernel currently (see bsc#1171903)
      - kernel-default
  zypper:
      name: '{{ pkg }}'
      state: present
      update_cache: yes
